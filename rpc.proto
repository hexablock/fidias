syntax = "proto3";

package fidias;

import "github.com/hexablock/hexatype/types.proto";
//import "github.com/hexablock/go-chord/net.proto";

service FidiasRPC {
    // Get key-value pair from remote
    rpc GetKeyRPC(KeyValuePair) returns (KeyValuePair) {}
    // Get versioned path from remote
    rpc GetPathRPC(PathRPC) returns (PathRPC) {}
    // Send key-location id pairs
    rpc RelocateRPC(stream KeyLocation) returns (stream KeyLocation) {}
    // Send block id and journal value
    rpc RelocateBlocksRPC(stream KeyLocation) returns (stream KeyLocation) {}
}

message KeyLocation {
    // Actual key
    bytes Key = 1;
    // Location id or last entry or id
    bytes Marker = 2;
    // Total known height of the key
    uint32 Height = 3;
}


message KeyValuePair {
    bytes Key = 1;
    bytes Value = 2;
    hexatype.Entry Entry = 3;
}

message FileVersion {
    string Alias = 1;
    bytes ID = 2;
}

message PathRPC {
    string Name = 1;
    repeated FileVersion Versions = 2;
    hexatype.Entry Entry = 3;
}